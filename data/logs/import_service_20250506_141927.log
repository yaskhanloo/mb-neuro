2025-05-06 14:19:27,209 - epic-import - INFO - Starting EPIC-secuTrial Import Service
2025-05-06 14:19:27,209 - epic-import - INFO - Using base directory: /app/data
2025-05-06 14:19:27,210 - epic-import - INFO - Latest secuTrial export: /app/data/sT-files/export-20250218
2025-05-06 14:19:27,210 - epic-import - INFO - Latest EPIC export: /app/data/EPIC-files/export-20250404
2025-05-06 14:19:27,210 - epic-import - INFO - Starting to merge EPIC files
2025-05-06 14:19:27,234 - epic-import - INFO - Detected encoding for encounters.csv: ISO-8859-1
2025-05-06 14:19:27,240 - epic-import - WARNING - Warning: Merge column 'PAT_ENC_CSN_ID' not found in encounters.csv
2025-05-06 14:19:27,240 - epic-import - WARNING - Available columns: ['PAT_ENC_CSN_ID\tname_last\tname_first\tbirth_date\tzip\tnon_swiss\tarrival_date\tarrival_time\tsex\ttransport\tliving_pre\theight\tweight\tdischarge_destinat\tdischarge_date\tdischarge_time']
2025-05-06 14:19:27,243 - epic-import - INFO - Detected encoding for flowsheet.csv: ascii
2025-05-06 14:19:27,247 - epic-import - WARNING - Warning: Merge column 'PAT_ENC_CSN_ID' not found in flowsheet.csv
2025-05-06 14:19:27,247 - epic-import - WARNING - Available columns: ['PAT_ENC_CSN_ID\tFID\tCONTACT_DATE\tnih_admission\tgcs_admission\tbp_syst\tbp_diast\tfirstangio_result\tivt_start_date\tivt_start_time\trtpa_dose\tiat_stentintracran\tiat_stentextracran\tmca\taca\tpca\tvertebrobasilar\tstroke_pre\ttia_pre\tich_pre\thypertension\tdiabetes\thyperlipidemia\tsmoking\tatrialfib\tchd\tprostheticvalves\tlowoutput\tpad\tdecompression\tdecompression_date']
2025-05-06 14:19:27,251 - epic-import - INFO - Detected encoding for imaging.csv: ascii
2025-05-06 14:19:27,253 - epic-import - WARNING - Warning: Merge column 'PAT_ENC_CSN_ID' not found in imaging.csv
2025-05-06 14:19:27,253 - epic-import - WARNING - Available columns: ['PAT_ENC_CSN_ID\tFID\tINCLUSION_STROKE_DOCUMENTATION\tINCLUSION_STROKE_FLAG\tfirstimage_type\tfirstimage_time\tfirstangio_type\tiat_mech\tfollow_mra\tfollow_cta\tfollow_ultrasound\tfollow_dsa\tfollow_tte\tfollow_tee\tfollow_holter']
2025-05-06 14:19:27,256 - epic-import - INFO - Detected encoding for lab_results.csv: ascii
2025-05-06 14:19:27,258 - epic-import - WARNING - Warning: Merge column 'PAT_ENC_CSN_ID' not found in lab_results.csv
2025-05-06 14:19:27,258 - epic-import - WARNING - Available columns: ['PAT_ENC_CSN_ID\tFID\tINCLUSION_STROKE_DOCUMENTATION\tINCLUSION_STROKE_FLAG\tinr\tglucose\tadmis_crp\tcreatinine\tcholesterol_total\tcholesterol_ldl\tadmis_haem\tadmis_lecuco\tadmis_platelets\tlevel_doac']
2025-05-06 14:19:27,314 - epic-import - INFO - Detected encoding for medications.csv: ISO-8859-1
2025-05-06 14:19:27,319 - epic-import - WARNING - Warning: Merge column 'PAT_ENC_CSN_ID' not found in medications.csv
2025-05-06 14:19:27,319 - epic-import - WARNING - Available columns: ['PAT_ENC_CSN_ID\tINCLUSION_STROKE_DOCUMENTATION\tINCLUSION_STROKE_FLAG\taspirin_pre\tclopidogrel_pre\tprasugrel_pre\tticagrelor_pre\tdipyridamole_pre\tvka_pre\trivaroxaban_pre\tdabigatran_pre\tapixaban_pre\tedoxaban_pre\tparenteralanticg_pre\tantihypertensive_pre\tantilipid_pre\thormone_pre\ttreat_antiplatelet\ttreat_anticoagulant\ttreat_ivt\tstatins_pre\tantihyper_pre\tother_pre']
2025-05-06 14:19:27,358 - epic-import - INFO - Detected encoding for monitoring.csv: ISO-8859-1
2025-05-06 14:19:27,360 - epic-import - INFO - Failed with encoding latin1: Error tokenizing data. C error: Expected 3 fields in line 25, saw 4

2025-05-06 14:19:27,361 - epic-import - INFO - Failed with encoding iso-8859-1: Error tokenizing data. C error: Expected 3 fields in line 25, saw 4

2025-05-06 14:19:27,363 - epic-import - INFO - Failed with encoding cp1252: Error tokenizing data. C error: Expected 3 fields in line 25, saw 4

2025-05-06 14:19:27,364 - epic-import - INFO - Failed with encoding utf-8-sig: 'utf-8' codec can't decode byte 0xdc in position 244: invalid continuation byte
2025-05-06 14:19:27,365 - epic-import - INFO - Failed with delimiter ',': Error tokenizing data. C error: Expected 3 fields in line 25, saw 4

2025-05-06 14:19:27,368 - epic-import - INFO - Successfully read monitoring.csv with delimiter: ';'
2025-05-06 14:19:27,368 - epic-import - WARNING - Warning: Merge column 'PAT_ENC_CSN_ID' not found in monitoring.csv
2025-05-06 14:19:27,368 - epic-import - WARNING - Available columns: ['PAT_ENC_CSN_ID\tFID\tINCLUSION_STROKE_DOCUMENTATION\tINCLUSION_STROKE_FLAG\tFLAG_USER\tFLAG_DATETIME\tARZTBERICHT_STATIONAR_AUTHOR\tADMISSION_DATE\tED_ARRIVAL\tLYSE_DTTM\tDOOR_TO_NEEDLE_MINUTES\tGROIN_PUNCTURE\tDOOR_TO_GROIN']
2025-05-06 14:19:27,376 - epic-import - INFO - Detected encoding for merged_epic_data.csv: utf-8
2025-05-06 14:19:27,392 - epic-import - INFO - File: merged_epic_data.csv | Columns: 107 , Rows: 2288
2025-05-06 14:19:27,393 - epic-import - INFO - Merged EPIC data with shape: (2288, 107)
2025-05-06 14:19:27,535 - epic-import - INFO - Loaded ID log with 1777 entries
2025-05-06 14:19:27,540 - epic-import - ERROR - Mapping file not found: /app/data/sT-import-validation/map_epic2secuTrial_import.xlsx
